{"ast":null,"code":"import _slicedToArray from\"/Users/santando/class~plus/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback,useRef}from'react';import apiConfig from'../../api.config';import PhotoView from'../../components/Photos';import{debounce}from'../../common/utilities';var Photos=function Photos(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),photos=_useState2[0],setPhotos=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isOpen=_useState6[0],setIsOpen=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setPage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),photoClickData=_useState10[0],setpPhotoClickData=_useState10[1];var resultsRef=useRef(null);useEffect(function(){resultsRef.current.addEventListener('scroll',function(){if(resultsRef.current&&window.pageYOffset+window.innerHeight>resultsRef.current.clientHeight-window.outerHeight*0.3){setPage(function(page){return page+1;});}});},[]);useEffect(function(){var getPhotosURL=apiConfig.getPhotos.url;fetch(\"\".concat(getPhotosURL,\"&per_page=10&page=\").concat(page,\"&format=json&nojsoncallback=1\")).then(function(response){return response.json();}).then(function(photoList){return setPhotos(photoList);}).catch(function(error){return console.log(error);});},[page]);var searchPhotos=function searchPhotos(){var searchPhotosURL=apiConfig.searchPhotos.url;fetch(\"\".concat(searchPhotosURL,\"&per_page=10&text=\").concat(searchTerm,\"&format=json&nojsoncallback=1\")).then(function(response){return response.json();}).then(function(photoList){return setPhotos(photoList);}).catch(function(error){return console.log(error);});};var debouncedSearch=useCallback(function(){return debounce(searchPhotos,2000);});var handleSearch=function handleSearch(event){var value=event.target.value;setSearchTerm(value);if(value.length>=3){debouncedSearch();}};var handleModalClose=function handleModalClose(){setIsOpen(false);};var photoClickHandler=function photoClickHandler(event,data){setIsOpen(function(isOpen){return!isOpen;});setpPhotoClickData(data);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"photo-list\"},/*#__PURE__*/React.createElement(PhotoView,{ref:resultsRef,photoList:photos,isOpen:isOpen,handleSearch:handleSearch,onPhotoClick:photoClickHandler,onModalClose:handleModalClose,photoClickData:photoClickData})));};export default Photos;","map":{"version":3,"sources":["/Users/santando/class~plus/src/containers/Photos/index.js"],"names":["React","useState","useEffect","useCallback","useRef","apiConfig","PhotoView","debounce","Photos","photos","setPhotos","searchTerm","setSearchTerm","isOpen","setIsOpen","page","setPage","photoClickData","setpPhotoClickData","resultsRef","current","addEventListener","window","pageYOffset","innerHeight","clientHeight","outerHeight","getPhotosURL","getPhotos","url","fetch","then","response","json","photoList","catch","error","console","log","searchPhotos","searchPhotosURL","debouncedSearch","handleSearch","event","value","target","length","handleModalClose","photoClickHandler","data"],"mappings":"iJAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,CAAqCC,WAArC,CAAkDC,MAAlD,KAAgE,OAAhE,CAEA,MAAOC,CAAAA,SAAP,KAAsB,kBAAtB,CACA,MAAOC,CAAAA,SAAP,KAAsB,yBAAtB,CACA,OAASC,QAAT,KAAyB,wBAAzB,CAEA,GAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACnB,cAA4BP,QAAQ,CAAC,EAAD,CAApC,wCAAOQ,MAAP,eAAeC,SAAf,eACA,eAAoCT,QAAQ,CAAC,EAAD,CAA5C,yCAAOU,UAAP,eAAmBC,aAAnB,eACA,eAA4BX,QAAQ,CAAC,KAAD,CAApC,yCAAOY,MAAP,eAAeC,SAAf,eACA,eAAwBb,QAAQ,CAAC,CAAD,CAAhC,yCAAOc,IAAP,eAAaC,OAAb,eACA,eAA6Cf,QAAQ,CAAC,EAAD,CAArD,0CAAOgB,cAAP,gBAAuBC,kBAAvB,gBAEA,GAAMC,CAAAA,UAAU,CAAGf,MAAM,CAAC,IAAD,CAAzB,CAEAF,SAAS,CAAC,UAAM,CACdiB,UAAU,CAACC,OAAX,CAAmBC,gBAAnB,CAAoC,QAApC,CAA8C,UAAM,CAClD,GACEF,UAAU,CAACC,OAAX,EACAE,MAAM,CAACC,WAAP,CAAqBD,MAAM,CAACE,WAA5B,CAA0CL,UAAU,CAACC,OAAX,CAAmBK,YAAnB,CAAkCH,MAAM,CAACI,WAAP,CAAqB,GAFnG,CAGE,CACAV,OAAO,CAAC,SAAAD,IAAI,QAAIA,CAAAA,IAAI,CAAG,CAAX,EAAL,CAAP,CACD,CACF,CAPD,EAQD,CATQ,CASN,EATM,CAAT,CAWAb,SAAS,CAAC,UAAM,CACd,GACoByB,CAAAA,YADpB,CAEItB,SAFJ,CACEuB,SADF,CACeC,GADf,CAGAC,KAAK,WAAIH,YAAJ,8BAAqCZ,IAArC,kCAAL,CACGgB,IADH,CACQ,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADhB,EAEGF,IAFH,CAEQ,SAAAG,SAAS,QAAIxB,CAAAA,SAAS,CAACwB,SAAD,CAAb,EAFjB,EAGGC,KAHH,CAGS,SAAAC,KAAK,QAAIC,CAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ,EAHd,EAID,CARQ,CAQN,CAACrB,IAAD,CARM,CAAT,CAUA,GAAMwB,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,EAAM,CACzB,GACuBC,CAAAA,eADvB,CAEInC,SAFJ,CACEkC,YADF,CACkBV,GADlB,CAGAC,KAAK,WAAIU,eAAJ,8BAAwC7B,UAAxC,kCAAL,CACGoB,IADH,CACQ,SAAAC,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADhB,EAEGF,IAFH,CAEQ,SAAAG,SAAS,QAAIxB,CAAAA,SAAS,CAACwB,SAAD,CAAb,EAFjB,EAGGC,KAHH,CAGS,SAAAC,KAAK,QAAIC,CAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAJ,EAHd,EAID,CARD,CAUA,GAAMK,CAAAA,eAAe,CAAGtC,WAAW,CAAC,UAAM,CACxC,MAAOI,CAAAA,QAAQ,CAACgC,YAAD,CAAe,IAAf,CAAf,CACD,CAFkC,CAAnC,CAIA,GAAMG,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAAC,KAAK,CAAI,CAC5B,GAAQC,CAAAA,KAAR,CAAkBD,KAAK,CAACE,MAAxB,CAAQD,KAAR,CACAhC,aAAa,CAACgC,KAAD,CAAb,CAEA,GAAIA,KAAK,CAACE,MAAN,EAAgB,CAApB,CAAuB,CACrBL,eAAe,GAChB,CACF,CAPD,CASA,GAAMM,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC7BjC,SAAS,CAAC,KAAD,CAAT,CACD,CAFD,CAIA,GAAMkC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACL,KAAD,CAAQM,IAAR,CAAiB,CACzCnC,SAAS,CAAC,SAAAD,MAAM,QAAI,CAACA,MAAL,EAAP,CAAT,CACAK,kBAAkB,CAAC+B,IAAD,CAAlB,CACD,CAHD,CAKA,mBACE,4CACE,2BAAK,SAAS,CAAC,YAAf,eAEI,oBAAC,SAAD,EACE,GAAG,CAAE9B,UADP,CAEE,SAAS,CAAEV,MAFb,CAGE,MAAM,CAAEI,MAHV,CAIE,YAAY,CAAE6B,YAJhB,CAKE,YAAY,CAAEM,iBALhB,CAME,YAAY,CAAED,gBANhB,CAOE,cAAc,CAAE9B,cAPlB,EAFJ,CADF,CADF,CAiBD,CA/ED,CAiFA,cAAeT,CAAAA,MAAf","sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\n\nimport apiConfig from '../../api.config';\nimport PhotoView from '../../components/Photos';\nimport { debounce } from '../../common/utilities';\n\nconst Photos = () => {\n  const [photos, setPhotos] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const [page, setPage] = useState(1);\n  const [photoClickData, setpPhotoClickData] = useState([]);\n\n  const resultsRef = useRef(null);\n\n  useEffect(() => {\n    resultsRef.current.addEventListener('scroll', () => {\n      if (\n        resultsRef.current &&\n        window.pageYOffset + window.innerHeight > resultsRef.current.clientHeight - window.outerHeight * 0.3\n      ) {\n        setPage(page => page + 1);\n      }\n    });\n  }, []);\n\n  useEffect(() => {\n    const {\n      getPhotos: { url: getPhotosURL }\n    } = apiConfig;\n    fetch(`${getPhotosURL}&per_page=10&page=${page}&format=json&nojsoncallback=1`)\n      .then(response => response.json())\n      .then(photoList => setPhotos(photoList))\n      .catch(error => console.log(error));\n  }, [page]);\n\n  const searchPhotos = () => {\n    const {\n      searchPhotos: { url: searchPhotosURL }\n    } = apiConfig;\n    fetch(`${searchPhotosURL}&per_page=10&text=${searchTerm}&format=json&nojsoncallback=1`)\n      .then(response => response.json())\n      .then(photoList => setPhotos(photoList))\n      .catch(error => console.log(error));\n  };\n\n  const debouncedSearch = useCallback(() => {\n    return debounce(searchPhotos, 2000);\n  });\n\n  const handleSearch = event => {\n    const { value } = event.target;\n    setSearchTerm(value);\n\n    if (value.length >= 3) {\n      debouncedSearch();\n    }\n  };\n\n  const handleModalClose = () => {\n    setIsOpen(false);\n  };\n\n  const photoClickHandler = (event, data) => {\n    setIsOpen(isOpen => !isOpen);\n    setpPhotoClickData(data);\n  };\n\n  return (\n    <div>\n      <div className=\"photo-list\">\n        {\n          <PhotoView\n            ref={resultsRef}\n            photoList={photos}\n            isOpen={isOpen}\n            handleSearch={handleSearch}\n            onPhotoClick={photoClickHandler}\n            onModalClose={handleModalClose}\n            photoClickData={photoClickData}\n          />\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default Photos;\n"]},"metadata":{},"sourceType":"module"}