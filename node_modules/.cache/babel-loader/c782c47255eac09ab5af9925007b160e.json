{"ast":null,"code":"import _slicedToArray from\"/Users/santando/class~plus/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useCallback,useRef}from'react';import apiConfig from'../../api.config';import PhotoView from'../../components/Photos';import{debounce,throttle}from'../../common/utilities';var Photos=function Photos(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),photos=_useState2[0],setPhotos=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),searchTerm=_useState4[0],setSearchTerm=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isOpen=_useState6[0],setIsOpen=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setPage=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),photoClickData=_useState10[0],setpPhotoClickData=_useState10[1];var resultsRef=useRef(null);var handleScroll=function handleScroll(){if(resultsRef.current&&window.pageYOffset+window.innerHeight>resultsRef.current.clientHeight-window.outerHeight*0.3){setPage(function(page){return page+1;});}};useEffect(function(){resultsRef.current.addEventListener('scroll',throttle(handleScroll,1000));return function(){return window.removeEventListener('scroll',throttle(handleScroll,1000));};},[]);useEffect(function(){var getPhotosURL=apiConfig.getPhotos.url;fetch(\"\".concat(getPhotosURL,\"&per_page=10&page=\").concat(page,\"&format=json&nojsoncallback=1\")).then(function(response){return response.json();}).then(function(photoList){return setPhotos(photoList);}).catch(function(error){return console.log(error);});},[page]);var debouncedCount=useCallback(debounce(function(){var searchPhotosURL=apiConfig.searchPhotos.url;console.log(searchTerm,'searchTerm');fetch(\"\".concat(searchPhotosURL,\"&per_page=10&text=\").concat(searchTerm,\"&format=json&nojsoncallback=1\")).then(function(response){return response.json();}).then(function(photoList){return setPhotos(photoList);}).catch(function(error){return console.log(error);});},1000),[searchTerm]);var handleSearch=function handleSearch(event){setSearchTerm(event.target.value);if(searchTerm.length>=3){debouncedCount();}};useEffect(function(){var getPhotosURL=apiConfig.getPhotos.url;fetch(\"\".concat(getPhotosURL,\"&per_page=10&page=\").concat(page,\"&format=json&nojsoncallback=1\")).then(function(response){return response.json();}).then(function(photoList){return setPhotos(photoList);}).catch(function(error){return console.log(error);});},[page]);var handleModalClose=function handleModalClose(){setIsOpen(false);};var photoClickHandler=function photoClickHandler(event,data){setIsOpen(function(isOpen){return!isOpen;});setpPhotoClickData(data);};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"photo-list\"},/*#__PURE__*/React.createElement(PhotoView,{ref:resultsRef,photoList:photos,isOpen:isOpen,handleSearch:handleSearch,onPhotoClick:photoClickHandler,onModalClose:handleModalClose,photoClickData:photoClickData})));};export default Photos;","map":{"version":3,"sources":["/Users/santando/class~plus/src/containers/Photos/index.js"],"names":["React","useState","useEffect","useCallback","useRef","apiConfig","PhotoView","debounce","throttle","Photos","photos","setPhotos","searchTerm","setSearchTerm","isOpen","setIsOpen","page","setPage","photoClickData","setpPhotoClickData","resultsRef","handleScroll","current","window","pageYOffset","innerHeight","clientHeight","outerHeight","addEventListener","removeEventListener","getPhotosURL","getPhotos","url","fetch","then","response","json","photoList","catch","error","console","log","debouncedCount","searchPhotosURL","searchPhotos","handleSearch","event","target","value","length","handleModalClose","photoClickHandler","data"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\n\nimport apiConfig from '../../api.config';\nimport PhotoView from '../../components/Photos';\nimport { debounce, throttle } from '../../common/utilities';\n\nconst Photos = () => {\n  const [photos, setPhotos] = useState([]);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [isOpen, setIsOpen] = useState(false);\n  const [page, setPage] = useState(1);\n  const [photoClickData, setpPhotoClickData] = useState([]);\n\n  const resultsRef = useRef(null);\n\n  const handleScroll = () => {\n    if (\n      resultsRef.current &&\n      window.pageYOffset + window.innerHeight > resultsRef.current.clientHeight - window.outerHeight * 0.3\n    ) {\n      setPage(page => page + 1);\n    }\n  };\n\n  useEffect(() => {\n    resultsRef.current.addEventListener('scroll', throttle(handleScroll, 1000));\n    return () => window.removeEventListener('scroll', throttle(handleScroll, 1000));\n  }, []);\n\n  useEffect(() => {\n    const {\n      getPhotos: { url: getPhotosURL }\n    } = apiConfig;\n    fetch(`${getPhotosURL}&per_page=10&page=${page}&format=json&nojsoncallback=1`)\n      .then(response => response.json())\n      .then(photoList => setPhotos(photoList))\n      .catch(error => console.log(error));\n  }, [page]);\n\n  const debouncedCount = useCallback(\n    debounce(() => {\n      const {\n        searchPhotos: { url: searchPhotosURL }\n      } = apiConfig;\n\n      console.log(searchTerm, 'searchTerm');\n\n      fetch(`${searchPhotosURL}&per_page=10&text=${searchTerm}&format=json&nojsoncallback=1`)\n        .then(response => response.json())\n        .then(photoList => setPhotos(photoList))\n        .catch(error => console.log(error));\n    }, 1000),\n    [searchTerm]\n  );\n\n  const handleSearch = event => {\n    setSearchTerm(event.target.value);\n    if (searchTerm.length >= 3) {\n      debouncedCount();\n    }\n  };\n\n  useEffect(() => {\n    const {\n      getPhotos: { url: getPhotosURL }\n    } = apiConfig;\n    fetch(`${getPhotosURL}&per_page=10&page=${page}&format=json&nojsoncallback=1`)\n      .then(response => response.json())\n      .then(photoList => setPhotos(photoList))\n      .catch(error => console.log(error));\n  }, [page]);\n\n  const handleModalClose = () => {\n    setIsOpen(false);\n  };\n\n  const photoClickHandler = (event, data) => {\n    setIsOpen(isOpen => !isOpen);\n    setpPhotoClickData(data);\n  };\n\n  return (\n    <div>\n      <div className=\"photo-list\">\n        {\n          <PhotoView\n            ref={resultsRef}\n            photoList={photos}\n            isOpen={isOpen}\n            handleSearch={handleSearch}\n            onPhotoClick={photoClickHandler}\n            onModalClose={handleModalClose}\n            photoClickData={photoClickData}\n          />\n        }\n      </div>\n    </div>\n  );\n};\n\nexport default Photos;\n"]},"metadata":{},"sourceType":"module"}